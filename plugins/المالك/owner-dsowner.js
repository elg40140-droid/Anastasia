/**
 * ๐ฏ ุฃูุฑ: ุญุฐู ุฌููุน ุฌูุณุงุช ุงูุจูุช
 * ๐ ุงูุตูุงุญูุงุช: ุงููุงูู ููุท
 * ๐ก๏ธ ุงููุธููุฉ: ุญุฐู ูู ูููุงุช ุงูุฌูุณุงุช ูุง ุนุฏุง creds.json
 * ๐ช ุงููุฆุฉ: ูุงูู
 * ๐ ุงููุงูู: ๐นโโข๐ ฤร๐ช๐เผ๐-๐๐ข๐๐นโโข๐
 */

import{readdirSync,unlinkSync,existsSync,promises as fs,rmSync}from'fs'
import path from 'path'

let handler=async(m,{conn,usedPrefix,tr})=>{
try{
if(global.conn.user.jid!==conn.user.jid){
return m.reply(await tr(m,`ุบูููุฑ ููุณููููุญ\n ููุฌูุจ ุงุณูุชูุฎูุฏุงู ููุฐุง ุงูุฃููุฑ\n ููู ุงููุฑููู ุงููุฑุฆูููุณูู ููููุจููุช ููููุท`))
}

await m.reply(await tr(m,`ุจูุฏุก ุนูููููููุฉ ุงููุญูุฐู\n ุฌูุงุฑู ุญูุฐู ุฌูููููุน ููููููุงุช ุงููุฌูููุณูุงุช\n ููุง ุนูุฏุง ููููู creds.json\n ููุฑุฌูู ุงููุงููุชูุธูุงุฑ...`))

let sessionPath=`./${global.sessions}/`
let filesDeleted=0

if(!existsSync(sessionPath)){
return m.reply(await tr(m,`ุงููููุฌูููุฏ ููุงุฑุบ\n ููู ุฃุนูุซูุฑ ุนูููู ููุฌูููุฏ ุงููุฌูููุณูุงุช\n ุฃู ุฃููู ููุงุฑุบ ุจุงููููุงููู`))
}

let files=await fs.readdir(sessionPath)

for(const file of files){
if(file!=='creds.json'){
await fs.unlink(path.join(sessionPath,file))
filesDeleted++
}
}

if(filesDeleted===0){
return m.reply(await tr(m,`ููู ููุชูู ุญูุฐู ุดููุก\n ููู ุฃุนูุซูุฑ ุนูููู ููููููุงุช ุฌูููุณูุงุช\n ููููุญูุฐู ููู ุงููููุฌูููุฏ`))
}

await m.reply(await tr(m,`ุชูู ุงููุญูุฐู ุจูููุฌูุงุญ\n ุนูุฏุฏ ุงููููููููุงุช ุงููููุญูุฐูููุฉ: ${filesDeleted}\n ุงููููููู ุงููููุญููููุธ: creds.json`))

// ๐ฏ ุฑุณุงูุฉ ุชุฃููุฏ ุงุชุตุงู ุงูุจูุช
await conn.sendMessage(m.chat,{
text:await tr(m,`ุชูุฃููููุฏ ุงููุงุชูุตูุงู\n ููุฑุญูุจูุงู ููุง ููุงููููู ุงููุบูุงููู!\n ููุนููุ ุฃููุฏุฑ ุนูููู ุฑุคููุชูู ๐ฅฐ\n ุงููุจููุช ููุงุฒุงู ููุชูุตููุงู ูุจูุฎูููุฑ\n ููุงุชูู ุจููุช - ุฌูุงููุฒุฉ ููุฎูุฏููุชูู`)
},{quoted:m})

}catch(err){
console.error('ุฎุทุฃ ูู ุญุฐู ุงูุฌูุณุงุช:',err)
m.reply(await tr(m,`ุญูุฏุซ ุฎูุทูุฃ\n ุงููุณูุจูุจ: ุฎูุทูุฃ ููู ููุธูุงู ุงููููููููุงุช\n ุงููุญูู: ุชูุฃููุฏ ููู ุตููุงุญูููุงุช ุงููููุฌูููุฏ`))
}
}

handler.command=['clearallsession','ุญุฐู_ุงูุฌูุณุงุช']
handler.help=['clearallsession - ุญุฐู ุฌููุน ุฌูุณุงุช ุงูุจูุช']
handler.tags=['ูุงูู']
handler.rowner=true

export default handler